!function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}({1:[function(require,module,exports){"use strict";var _ext2=_interopRequireDefault(require("./utils/ext")),_Messenger2=_interopRequireDefault(require("./transport/Messenger"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var signinelement=document.querySelector("#signin"),signoutelement=document.querySelector("#signout"),userElement=document.getElementById("username"),pwdElement=document.getElementById("password"),btnCopy=document.getElementById("btncopy"),btnPaste=document.getElementById("btnpaste"),warningElem=document.querySelector("#warning"),profileContainer=document.querySelector(".divprofile"),loginContainer=document.querySelector(".formlogin");document.querySelector(".usercredits");function hideElement(containerElement){containerElement.classList.remove("visible"),containerElement.classList.add("hidden")}function showElement(containerElement){containerElement.classList.remove("hidden"),containerElement.classList.add("visible")}function hideProfile(){hideElement(profileContainer),showElement(loginContainer),document.querySelector("#username").focus()}function formatNextResetDate(str){return null==str?"Not Applicable":function(str){if(null==str)return"";try{return new Date(str)}catch(e){return""}}(str)}function showProfile(user){hideElement(loginContainer),showElement(profileContainer),document.querySelector("#displayname").innerHTML=user.displayName,document.querySelector("#useremail").innerHTML=user.email,document.querySelector("#planname").innerHTML=user.plan.name,console.log(user),document.querySelector("#nextreset").innerHTML=formatNextResetDate(user.userPlanDetail.nextresetdate),document.querySelector("#planname").setAttribute("title",user.plan.description),updateCredits(user.userPlanDetail.currentcredits)}function updateCredits(credits){document.querySelector("#usercredits").innerHTML=credits+" credits"}function hideError(){hideElement(warningElem)}function showError(msg){showElement(warningElem),warningElem.innerHTML=msg}function showTimedError(msg){showError(msg),setTimeout(function(){hideError()},1e4)}function signIn(){hideError();var email=userElement.value,password=pwdElement.value;(function(email,password){return email.length<4?(showTimedError("Please enter an email address."),!1):!(password.length<4&&(showTimedError("Please enter a password."),1))})(email,password)&&(signinelement.disabled=!0,_ext2.default.runtime.sendMessage({action:"login",email:email,password:password},function(response){if(console.log("Response after login",response),response.user)showProfile(response.user);else{var error=response.error,errorCode=error.code,errorMessage=error.message;showTimedError("auth/wrong-password"===errorCode?"Wrong password.":errorMessage),console.log(error),pwdElement.value="",signinelement.disabled=!1}}))}function showProgress(){document.querySelector(".progress").className="progress appprogress",document.querySelector(".copypastebtns").className="row copypastebtns hidden"}function hideProgress(){document.querySelector(".progress").className="progress appprogress hidden",document.querySelector(".copypastebtns").className="row copypastebtns"}function disablePaste(){btnPaste.disabled=!0}function disableCopy(){btnCopy.disabled=!0}function enablePaste(){btnPaste.disabled=!1}function validateCredit(){_ext2.default.runtime.sendMessage({action:"has-credit"},function(response){var msg;response&&response.error?(msg=response.error,disablePaste(),disableCopy(),showError(msg)):function(response){console.log("usageInProgress",response),1!=response.usageInProgress?response.hasCopyData?enablePaste():disablePaste():showProgress()}(response)})}function initApp(){_ext2.default.runtime.sendMessage({action:"user-status"},function(response){console.log("user-status",response),hideProgress(),response&&response.user?function(response){console.log(response),showProfile(response.user),validateCredit()}(response):hideProfile()})}signoutelement.addEventListener("click",function(e){e.preventDefault(),console.log("sign out"),showProgress(),_ext2.default.runtime.sendMessage({action:"signout"},function(response){window.location.reload(!0)})}),btnCopy.addEventListener("click",function(e){e.preventDefault(),showProgress(),_Messenger2.default.sendToBackground({action:"copy-current-page"},function(response){})}),btnPaste.addEventListener("click",function(e){e.preventDefault(),showProgress(),_Messenger2.default.sendToBackground({action:"send-paste-data"},function(response){})}),signinelement.addEventListener("click",function(e){e.preventDefault(),signIn()}),window.onload=function(){showProgress(),hideProfile(),initApp(),_Messenger2.default.waitForBackgroundMessage(function(request,sender,response){var credits;console.log("received popup stuff",request),"enable_copy"===request.action&&(btnCopy.disabled=!1),"disable_all"===request.action&&(disableCopy(),disablePaste()),"enable_paste"===request.action&&enablePaste(),"disable_copy"===request.action&&disableCopy(),"disable_paste"===request.action&&disablePaste(),"update_credits"===request.action&&((credits=request.currentcredits)<=0&&validateCredit(),updateCredits(credits)),"reload"===request.action&&initApp(),"hideprogress"===request.action&&(console.log("received hide progress"),hideProgress())})}},{"./transport/Messenger":2,"./utils/ext":3}],2:[function(require,module,exports){"use strict";var obj,_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_ext=require("../utils/ext"),_ext2=(obj=_ext)&&obj.__esModule?obj:{default:obj};var Messenger=function(){function Messenger(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Messenger)}return _createClass(Messenger,[{key:"sendToActiveTab",value:function(request,cb){_ext2.default.tabs.query({active:!0,currentWindow:!0},function(tabs){_ext2.default.tabs.sendMessage(tabs[0].id,request,function(evt){null!=cb&&null!=cb&&cb(evt)})})}},{key:"openInActiveTab",value:function(url,cb){_ext2.default.tabs.query({active:!0,currentWindow:!0},function(tabs){_ext2.default.tabs.update(tabs[0].id,{url:url,highlighted:!0},function(evt){null!=cb&&null!=cb&&cb(evt)})})}},{key:"reloadActiveTab",value:function(cb){_ext2.default.tabs.query({active:!0,currentWindow:!0},function(tabs){_ext2.default.tabs.executeScript(tabs[0].id,{code:"window.location.reload();"},function(evt){null!=cb&&null!=cb&&cb(evt)})})}},{key:"sendToBackground",value:function(request,cb){_ext2.default.runtime.sendMessage(request,function(response){null!=cb&&null!=cb&&cb(response)})}},{key:"sendToPopup",value:function(request,cb){_ext2.default.runtime.sendMessage(request,function(response){null!=cb&&null!=cb&&cb(response)})}},{key:"waitForBackgroundMessage",value:function(cb){_ext2.default.runtime.onMessage.addListener(function(request,sender,response){null!=cb&&null!=cb&&cb(request,sender,response)})}}]),Messenger}();module.exports=new Messenger},{"../utils/ext":3}],3:[function(require,module,exports){"use strict";var apis=["alarms","bookmarks","browserAction","commands","contextMenus","cookies","downloads","events","extension","extensionTypes","history","i18n","idle","notifications","pageAction","runtime","storage","tabs","webNavigation","webRequest","windows"];module.exports=new function(){var _this=this;apis.forEach(function(api){_this[api]=null;try{chrome[api]&&(_this[api]=chrome[api])}catch(e){}try{window[api]&&(_this[api]=window[api])}catch(e){}try{browser[api]&&(_this[api]=browser[api])}catch(e){}try{_this.api=browser.extension[api]}catch(e){}});try{browser&&browser.runtime&&(this.runtime=browser.runtime)}catch(e){}try{browser&&browser.browserAction&&(this.browserAction=browser.browserAction)}catch(e){}}},{}]},{},[1]);